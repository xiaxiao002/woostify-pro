"use strict";var frame,woostifyData=woostify_variation_swatches_admin||{};document.addEventListener("DOMContentLoaded",function(){var i=window.wp,t=jQuery("body"),o=(jQuery("#term-color").wpColorPicker(),t.on("click",".woostify-variation-swatches-upload-image-button",function(t){t.preventDefault();var a=jQuery(this);frame||(frame=i.media.frames.downloadable_file=i.media({title:woostifyData.i18n.mediaTitle,button:{text:woostifyData.i18n.mediaButton},multiple:!1})).on("select",function(){var t=frame.state().get("selection").first().toJSON();a.siblings("input.woostify-variation-swatches-term-image").val(t.id),a.siblings(".woostify-variation-swatches-remove-image-button").show(),a.parent().prev(".woostify-variation-swatches-term-image-thumbnail").find("img").attr("src",t.sizes.thumbnail.url)}),frame.open()}).on("click",".woostify-variation-swatches-remove-image-button",function(){var t=jQuery(this);return t.siblings("input.woostify-variation-swatches-term-image").val(""),t.siblings(".woostify-variation-swatches-remove-image-button").show(),t.parent().prev(".woostify-variation-swatches-term-image-thumbnail").find("img").attr("src",woostifyData.placeholder),!1}),jQuery("#woostify-variation-swatches-modal-container")),s=o.find(".spinner"),n=o.find(".message"),r=null;function c(){o.find(".woostify-variation-swatches-term-name input, .woostify-variation-swatches-term-slug input").val(""),s.removeClass("is-active"),n.removeClass("error success").hide(),o.hide()}t.on("click",".variation_swatches_add_new_attribute",function(t){t.preventDefault();var t=jQuery(this),a=i.template("woostify-variation-swatches-input-tax"),e={type:t.data("type"),tax:t.closest(".woocommerce_attribute").data("taxonomy")};o.find(".woostify-variation-swatches-term-swatch").html(jQuery("#tmpl-woostify-variation-swatches-input-"+e.type).html()),o.find(".woostify-variation-swatches-term-tax").html(a(e)),"color"==e.type&&o.find("input.woostify-variation-swatches-input-color").wpColorPicker(),r=t.closest(".woocommerce_attribute.wc-metabox"),o.show()}).on("click",".woostify-variation-swatches-modal-close, .woostify-variation-swatches-modal-backdrop",function(t){t.preventDefault(),c()}),t.on("click",".woostify-variation-swatches-new-attribute-submit",function(t){t.preventDefault();jQuery(this).data("type");var a=!1,e={};o.find(".woostify-variation-swatches-input").each(function(){var t=jQuery(this);"slug"==t.attr("name")||t.val()?t.removeClass("error"):(t.addClass("error"),a=!0),e[t.attr("name")]=t.val()}),a||(s.addClass("is-active"),n.hide(),i.ajax.send("variation_swatches_add_new_attribute",{data:e,error:function(t){s.removeClass("is-active"),n.addClass("error").text(t).show()},success:function(t){s.removeClass("is-active"),n.addClass("success").text(t.msg).show(),r.find("select.attribute_values").append('<option value="'+t.id+'" selected="selected">'+t.name+"</option>"),r.find("select.attribute_values").change(),c()}}))})});