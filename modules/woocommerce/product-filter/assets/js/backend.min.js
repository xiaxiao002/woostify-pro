"use strict";var woostifyRangeValue=function(){var e,t,o,i=document.querySelector(".w-filter-check-range");i&&((e=function(){var e=i.querySelectorAll(".w-filter-item-pack");e.length&&e.forEach(function(e){var t=e.querySelector(".w-filter-range-item-remove");t&&(t.onclick=function(){e.remove()})})})(),t=i.querySelector(".w-filter-container-inner"),o=i.querySelector(".w-filter-range-item-add"),t&&o&&(o.onclick=function(){t.insertAdjacentHTML("beforeend",woostify_product_filter.item_node),e()}))},woostifyUpdateAttr=function(){var o,i=document.querySelector('[name="woostify_product_filter_type"]');i&&(o=i.closest(".admin-product-filter"),i.addEventListener("change",function(){var e=document.querySelector('[name="woostify_product_filter_data"]'),t=document.querySelectorAll(".w-filter-check-range .w-filter-required");o.setAttribute("data-type",i.value),t.length&&("check-range"===i.value?t.forEach(function(e){e.setAttribute("required","required")}):t.forEach(function(e){e.removeAttribute("required"),e.value.trim()||e.closest(".w-filter-range-item").remove()})),"visual"===i.value&&e?(e.classList.add("product-attr-only"),(t=e.querySelector("[value="+e.value+"]"))&&t.classList.contains("product-taxonomy")&&(e.value="")):"stock"===i.value&&e?(e.classList.add("stock"),e.classList.remove("product-attr-only")):(e.classList.remove("product-attr-only"),e.classList.remove("stock"))}))},woostifyToggleCheckboxValue=function(){var e=document.querySelectorAll('.woostify-filter-item [type="checkbox"]');e.length&&e.forEach(function(a){function e(){var e=a.name,t=e+":"+a.value,o=document.querySelectorAll("[data-require]");if(o.length)for(var i=0,r=o.length;i<r;i++){var n=o[i].getAttribute("data-require");n.includes(e)&&(n===t?o[i].classList.remove("hidden"):o[i].classList.add("hidden"))}}e(),a.addEventListener("change",function(){a.value="1"==a.value?"0":"1",e()})})},woostifyProductCatData=function(){var e,t,o,i,r=document.querySelector('[name="woostify_product_filter_data"]'),n=document.querySelector(".w-filter-hierarchical-data");r&&n&&((e=function(){"product_cat"==r.value?n.classList.remove("hidden"):n.classList.add("hidden")})(),r.onchange=e,t=n.querySelector("#w-filter-source-term-hierarchical"),o=n.querySelector("#w-filter-source-term-hierarchical-expand"),i=document.querySelector(".soft-limit"),t&&o&&t.addEventListener("change",function(){var e=o.closest(".w-filter-field");"0"==t.value?(e.classList.add("hidden"),i&&i.classList.remove("soft-limit-hidden")):(e.classList.remove("hidden"),i&&i.classList.add("soft-limit-hidden"))}))},woostifyProductStock=function(){var e,t=document.querySelector('[name="woostify_product_filter_type"]'),o=document.querySelector('[name="woostify_product_filter_data"]');t&&o&&((e=function(){"checkbox"==t.value?o.classList.remove("hidden"):o.classList.add("hidden")})(),t.onchange=e)},woostifyProductStockType=function(){var e,t=document.querySelector('[name="woostify_product_filter_type"]'),o=document.querySelector(".w-filter-stock-data"),i=document.querySelector(".soft-limit");t&&o&&((e=function(){"stock"==t.value?(o.classList.remove("hidden"),i.classList.add("hidden")):(o.classList.add("hidden"),i.classList.remove("hidden"))})(),t.onchange=e)},woostifyTermConditionData=function(){var e,t=document.querySelector(".w-filter-condition-data"),o=!!t&&t.querySelector(".w-filter-condition-select"),i=!!t&&t.querySelector(".w-filter-condition-field");o&&i&&((e=function(){o.value?i.classList.remove("hidden"):i.classList.add("hidden")})(),t.onchange=e)},woostifyFieldShowOn=function(e){var e=document.querySelectorAll(e),t=document.querySelector('[name="woostify_product_filter_type"]');e.length&&"stock"!=t.value&&e.forEach(function(t){var e=t.getAttribute("showon").split(":"),o=e[0],i=!0,r=((i=void 0!==e[0].split("!")[1]?!1:i)||(o=e[0].split("!")[0]),e[1]),e=document.getElementsByName(o)[0],o=e.value;return i?(o===r?t.classList.remove("hidden"):t.classList.add("hidden"),e.addEventListener("change",function(e){e.target.value===r?t.classList.add("hidden"):t.classList.remove("hidden")})):(o!==r?t.classList.remove("hidden"):t.classList.add("hidden"),e.addEventListener("change",function(e){e.target.value===r?t.classList.add("hidden"):t.classList.remove("hidden")})),!1})},woostifySortableOrder=function(){var e=document.querySelector(".woostify-multi-selection-inner"),t=!!e&&e.closest(".woostify-multi-selection"),o=!!t&&t.querySelector(".woostify-multi-select-value");e&&(new Sortable(e),document.addEventListener("filterOrder",function(){var t=[];e.querySelectorAll(".woostify-multi-select-id").forEach(function(e){e=e.getAttribute("data-id");e&&!t.includes(e)&&t.push(e)}),o.value=t.join("|")}))},woostifyIndexDatabase=function(){var r=document.querySelector(".filter-index-button");r&&(r.onclick=function(){var e=r.closest(".form-table"),o=!!e&&e.querySelector(".last-index"),i=!!e&&e.querySelector(".index-count");o&&i&&!r.getAttribute("disabled")&&!r.parentNode.classList.contains("loading")&&(r.parentNode.classList.add("loading"),r.setAttribute("disabled","disabled"),r.innerHTML=woostify_product_filter.indexing_text+"...",e={action:"woostify_index_filter",ajax_nonce:woostify_product_filter.ajax_nonce},e=new URLSearchParams(e).toString(),e=new Request(ajaxurl,{method:"POST",body:e,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(e).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),e;return e.json()}).then(function(e){var t;e.success&&(e=e.data,r.innerHTML=woostify_product_filter.indexed_text,r.insertAdjacentHTML("afterend",'<span class="info-seuccess">'+woostify_product_filter.indexed_success+"</span>"),r.parentNode.classList.remove("loading"),(t=document.querySelector(".woostify-filter-index-notice"))&&t.remove(),e.time&&(o.innerHTML=e.time),e.total&&(i.innerHTML=e.total))}).catch(function(){r.parentNode.classList.remove("loading")}))})},woostifySortableFilter=function(){var t=jQuery("table.wp-list-table #the-list");t.sortable({items:"tr",axis:"y",update:function(){var e=t.sortable("serialize");(e=(e=e.replaceAll("&post[]=",",")).replace("post[]=","")).includes(",")&&(e={action:"woostify_filter_list_sortable",post_ids:e,ajax_nonce:woostify_product_filter.ajax_sortable_nonce},e=new URLSearchParams(e).toString(),e=new Request(ajaxurl,{method:"POST",body:e,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(e))}})},woostifySelectText=function(){var e=document.querySelectorAll(".w-filter-shortcode");e.length&&window.getSelection&&e.forEach(function(t){t.onclick=function(){var e=document.createRange();e.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(e)}})};document.addEventListener("DOMContentLoaded",function(){woostifyToggleCheckboxValue(),woostifyRangeValue(),woostifyUpdateAttr(),woostifyProductCatData(),woostifyTermConditionData(),woostifySortableOrder(),woostifyIndexDatabase(),woostifyFieldShowOn(".woostify-smart-product-filter-product-setting tr[showon]"),woostifyFieldShowOn(".admin-product-filter tr[showon]"),woostifySortableFilter(),woostifySelectText(),woostifyProductStockType()});