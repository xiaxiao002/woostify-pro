"use strict";var checkLicenses=function(){var d=document.getElementById("woostify_license_key_field"),r=document.getElementById("woostify_pro_license_key_submit");d&&r&&(r.onclick=function(e){e.preventDefault();var s,e=d.value.trim(),i=document.querySelector(".license-key-message");e.length?(r.classList.add("updating-message"),e=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_check_licenses&ajax_nonce="+woostify_pro_dashboard.ajax_nonce+"&woostify_license_key="+e,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),s=function(){i&&(i.innerHTML=woostify_pro_dashboard.not_receiving,i.classList.add("not-receiving-updates"),i.classList.remove("receiving-updates")),r.innerHTML=woostify_pro_dashboard.activate_label,d.disabled=!1},fetch(e).then(function(e){if(200!==e.status)return console.log("Status Code: "+e.status),void r.classList.remove("updating-message");e.json().then(function(e){for(var t,o=!1,a="activate",n=0,c=e.length;n<c;n++)!function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(e[n])||(t=JSON.parse(e[n])).success&&(t.success&&"valid"===t.license?o=!0:t.success&&"deactivated"===t.license&&(o=!0,a="deactivate"));o?"activate"==a?(alert(woostify_pro_dashboard.activate_success_message),i&&(i.innerHTML=woostify_pro_dashboard.receiving,i.classList.remove("not-receiving-updates"),i.classList.add("receiving-updates")),r.innerHTML=woostify_pro_dashboard.deactivate_label,d.disabled=!0):(alert(woostify_pro_dashboard.deactivate_success_message),s()):(s(),alert(woostify_pro_dashboard.failure_message))})}).catch(function(e){console.log(e)}).finally(function(){r.classList.remove("updating-message")})):alert(woostify_pro_dashboard.license_empty)})},moduleCheckbox=function(){var t=document.getElementById("woostify-select-all");t&&t.addEventListener("click",function(){var e=document.querySelectorAll(".module-checkbox");e.length&&e.forEach(function(e){e.closest(".module-item.disabled")||(t.checked?e.checked=!0:e.checked=!1,e.addEventListener("click",function(){t.checked=!1},{once:!0}))})})},detectFeature=function(){var e=document.querySelectorAll(".module-item"),t=document.querySelectorAll(".module-item.activated");e.length&&(e=e.length==t.length?"yes":"",t=new Request(ajaxurl,{method:"POST",body:"action=all_feature_activated&detect="+e+"&ajax_nonce="+woostify_pro_dashboard.ajax_nonce,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(t))},moduleAction=function(){var e=document.querySelector(".woostify-module-list");!e||(e=e.querySelectorAll(".module-item")).length&&e.forEach(function(e){var n=e.querySelector(".module-action-button");n&&(n.onclick=function(){var t=n.closest(".module-item"),e=n.getAttribute("data-name"),o=n.getAttribute("data-value"),a=woostify_pro_dashboard.activating,e=("activated"===o&&(a=woostify_pro_dashboard.deactivating),new Request(ajaxurl,{method:"POST",body:"action=module_action&name="+e+"&status="+o+"&ajax_nonce="+woostify_pro_dashboard.ajax_nonce,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}));n.innerHTML=a,t.classList.add("loading"),fetch(e).then(function(e){200===e.status?e.json().then(function(e){e.success&&(n.setAttribute("data-value",e.data.status),n.innerHTML="activated"===e.data.status?"deactivate":"activate",t.className="",t.classList.add("module-item",e.data.status),detectFeature())}):console.log("Status Code: "+e.status)}).finally(function(){t.classList.remove("loading")})})})},multiModuleAction=function(){var e=document.querySelector(".multi-module-action"),t=document.querySelector(".multi-module-action-button"),o=document.querySelectorAll(".module-item:not(.disabled)");e&&t&&o.length&&t.addEventListener("click",function(){var c=e.value.trim();c&&o.forEach(function(e,t){var o=e.querySelector(".module-checkbox"),a=e.querySelector(".module-action-button"),n=a.getAttribute("data-value").trim();e.classList.contains(".loading")?alert("Process running."):c!==n&&o.checked&&setTimeout(function(){a.click()},200*t)})})};document.addEventListener("DOMContentLoaded",function(){checkLicenses(),moduleCheckbox(),moduleAction(),multiModuleAction()});